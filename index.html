<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Helios :: Bitcoin Network Core</title>
    
    <!-- Tailwind CSS for rapid, responsive styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts for the futuristic aesthetic -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        /* Custom styles extending Tailwind */
        :root {
            --glow-color: #ff9800; /* Bitcoin Orange */
            --core-color-1: rgba(255, 152, 0, 0.8);
            --core-color-2: rgba(255, 87, 34, 0.6);
            --bg-color: #0a0a0f;
            --text-color: #e0e0e0;
            --text-muted-color: #8a8a9e;
            --panel-bg-color: rgba(20, 20, 35, 0.5);
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            background-image:
                radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.03) 0%, transparent 40%),
                radial-gradient(circle at 75% 75%, rgba(255, 255, 255, 0.03) 0%, transparent 40%);
            overflow: hidden; /* Hide scrollbars to maintain the immersive feel */
        }

        /* Use Orbitron font for headings and key data points */
        .font-orbitron {
            font-family: 'Orbitron', sans-serif;
        }

        /* The central pulsating core */
        #fusion-core {
            width: 150px;
            height: 150px;
            background: radial-gradient(circle, var(--core-color-1), var(--core-color-2));
            border-radius: 50%;
            box-shadow:
                0 0 20px var(--core-color-1),
                0 0 40px var(--core-color-1),
                0 0 60px var(--core-color-2),
                inset 0 0 15px rgba(255, 255, 255, 0.5);
            animation: pulse 4s infinite ease-in-out;
            transition: transform 0.3s ease;
        }

        /* Data panels with a holographic, glowing effect */
        .data-panel {
            background-color: var(--panel-bg-color);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 152, 0, 0.2);
            border-radius: 1rem;
            box-shadow: 0 0 15px rgba(255, 152, 0, 0.1);
            transition: all 0.3s ease;
            animation: fadeIn 1s ease-out;
        }

        .data-panel:hover {
            border-color: rgba(255, 152, 0, 0.5);
            box-shadow: 0 0 25px rgba(255, 152, 0, 0.3);
            transform: translateY(-5px);
        }

        /* Animation for the core's pulse */
        @keyframes pulse {
            0%, 100% { transform: scale(0.95); box-shadow: 0 0 20px var(--core-color-1), 0 0 40px var(--core-color-1), 0 0 60px var(--core-color-2), inset 0 0 15px rgba(255, 255, 255, 0.5); }
            50% { transform: scale(1.05); box-shadow: 0 0 30px var(--core-color-1), 0 0 60px var(--core-color-1), 0 0 90px var(--core-color-2), inset 0 0 20px rgba(255, 255, 255, 0.7); }
        }

        /* Animation for data updates */
        .flash {
            animation: flash-animation 0.7s ease-out;
        }
        @keyframes flash-animation {
            0% { color: var(--glow-color); text-shadow: 0 0 10px var(--glow-color); }
            100% { color: inherit; text-shadow: none; }
        }
        
        /* General fade-in for elements */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <div id="helios-widget" class="w-full max-w-7xl mx-auto">
        
        <!-- Header -->
        <header class="text-center mb-8" style="animation: fadeIn 0.5s ease-out;">
            <h1 class="font-orbitron text-4xl md:text-5xl font-bold tracking-widest text-white">HELIOS</h1>
            <p class="text-lg text-gray-400">BITCOIN NETWORK CORE</p>
        </header>

        <!-- Main Grid Layout -->
        <main class="grid grid-cols-1 lg:grid-cols-3 gap-8 items-center">

            <!-- Left Panel: Monetary Vector -->
            <div class="data-panel p-6 order-2 lg:order-1">
                <h2 class="font-orbitron text-2xl text-center mb-4 border-b border-orange-500/20 pb-2">Monetary Vector</h2>
                <div class="space-y-4 text-lg">
                    <div class="flex justify-between items-baseline">
                        <span class="text-gray-400">Circulating Supply:</span>
                        <span id="circulating-supply" class="font-bold text-white text-xl">Loading...</span>
                    </div>
                    <div class="flex justify-between items-baseline">
                        <span class="text-gray-400">Block Reward:</span>
                        <span id="block-reward" class="font-bold text-white text-xl">Loading...</span>
                    </div>
                    <div class="flex justify-between items-baseline">
                        <span class="text-gray-400">Next Halving In:</span>
                        <span id="next-halving-blocks" class="font-bold text-white text-xl">Loading...</span>
                    </div>
                    <div class="flex justify-between items-baseline">
                        <span class="text-gray-400">Est. Halving Date:</span>
                        <span id="next-halving-date" class="font-bold text-white text-xl">Loading...</span>
                    </div>
                </div>
            </div>

            <!-- Center: Core and Market Vector -->
            <div class="flex flex-col items-center justify-center space-y-8 order-1 lg:order-2">
                <div id="fusion-core"></div>
                <div class="data-panel p-6 w-full max-w-sm text-center">
                    <h2 class="font-orbitron text-2xl mb-2">Market Vector</h2>
                    <p class="font-orbitron text-5xl font-bold text-orange-400" id="price-usd">Loading...</p>
                </div>
            </div>

            <!-- Right Panel: Mining Vector -->
            <div class="data-panel p-6 order-3 lg:order-3">
                <h2 class="font-orbitron text-2xl text-center mb-4 border-b border-orange-500/20 pb-2">Mining Vector</h2>
                <div class="space-y-4 text-lg">
                    <div class="flex justify-between items-baseline">
                        <span class="text-gray-400">Difficulty Change:</span>
                        <span id="difficulty-change" class="font-bold text-white text-xl">Loading...</span>
                    </div>
                    <div class="flex justify-between items-baseline">
                        <span class="text-gray-400">Next Retarget In:</span>
                        <span id="next-retarget-blocks" class="font-bold text-white text-xl">Loading...</span>
                    </div>
                    <div class="flex justify-between items-baseline">
                        <span class="text-gray-400">Est. Retarget Date:</span>
                        <span id="estimated-retarget-date" class="font-bold text-white text-xl">Loading...</span>
                    </div>
                </div>
            </div>

        </main>
        
        <!-- Footer -->
        <footer class="text-center mt-12 text-gray-500" style="animation: fadeIn 1.5s ease-out;">
            <p id="timestamp">Awaiting data...</p>
            <a href="#" id="fuel-the-core" class="mt-2 inline-block text-orange-400 hover:text-orange-300 hover:underline transition-colors">
                Fuel the Core
            </a>
        </footer>
        
    </div>

    <script>
        // --- DOM ELEMENT REFERENCES ---
        const elements = {
            price: document.getElementById('price-usd'),
            supply: document.getElementById('circulating-supply'),
            reward: document.getElementById('block-reward'),
            halvingBlocks: document.getElementById('next-halving-blocks'),
            halvingDate: document.getElementById('next-halving-date'),
            diffChange: document.getElementById('difficulty-change'),
            retargetBlocks: document.getElementById('next-retarget-blocks'),
            retargetDate: document.getElementById('estimated-retarget-date'),
            timestamp: document.getElementById('timestamp')
        };
        
        let lastData = {};

        // --- DATA FETCHING & UPDATING ---

        /**
         * Fetches data from the local data.json file.
         */
        async function fetchData() {
            try {
                // Add a cache-busting query parameter to ensure we always get the latest file
                const response = await fetch(`data.json?v=${new Date().getTime()}`);
                if (!response.ok) {
                    throw new Error(`Network response was not ok: ${response.statusText}`);
                }
                const data = await response.json();
                updateDisplay(data);
            } catch (error) {
                console.error("Failed to fetch Helios data:", error);
                elements.timestamp.textContent = "Error: Could not load data core. Is the harvester running?";
            }
        }

        /**
         * Updates the DOM with the new data and adds a visual flash effect.
         * @param {object} data The data object from data.json.
         */
        function updateDisplay(data) {
            // Market Vector
            updateElement(elements.price, `$${parseFloat(data.market_vector.price_usd).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`, lastData.market_vector?.price_usd);

            // Mining Vector
            const diffChange = parseFloat(data.mining_vector.difficulty_change_percent);
            const diffChangeText = `${diffChange.toFixed(2)}%`;
            const diffChangeColor = diffChange > 0 ? 'text-green-400' : 'text-red-400';
            updateElement(elements.diffChange, diffChangeText, lastData.mining_vector?.difficulty_change_percent, diffChangeColor);
            
            updateElement(elements.retargetBlocks, `${parseInt(data.mining_vector.next_retarget_blocks).toLocaleString('en-US')} Blocks`, lastData.mining_vector?.next_retarget_blocks);
            updateElement(elements.retargetDate, data.mining_vector.estimated_retarget_date, lastData.mining_vector?.estimated_retarget_date);

            // Monetary Vector
            updateElement(elements.supply, parseInt(data.monetary_vector.circulating_supply).toLocaleString('en-US'), lastData.monetary_vector?.circulating_supply);
            updateElement(elements.reward, `${data.monetary_vector.current_block_reward} BTC`, lastData.monetary_vector?.current_block_reward);
            updateElement(elements.halvingBlocks, `${parseInt(data.monetary_vector.blocks_until_next_halving).toLocaleString('en-US')} Blocks`, lastData.monetary_vector?.blocks_until_next_halving);
            updateElement(elements.halvingDate, data.monetary_vector.next_halving_estimated_date, lastData.monetary_vector?.next_halving_estimated_date);
            
            // Timestamp
            const updateTime = new Date(data.timestamp_utc);
            elements.timestamp.textContent = `Data Core Forged: ${updateTime.toLocaleString()}`;

            lastData = data; // Store the new data for the next comparison
        }
        
        /**
         * Helper function to update an element's text and apply a flash animation if the value has changed.
         * @param {HTMLElement} el The DOM element to update.
         * @param {string} newValue The new text content for the element.
         * @param {*} oldValue The previous value to compare against.
         * @param {string} [colorClass] Optional color class to apply (e.g., for positive/negative values).
         */
        function updateElement(el, newValue, oldValue, colorClass) {
            if (el.textContent !== newValue) {
                el.textContent = newValue;
                el.classList.add('flash');
                
                // Reset color classes before adding a new one
                el.classList.remove('text-green-400', 'text-red-400', 'text-white');
                if (colorClass) {
                    el.classList.add(colorClass);
                } else {
                    el.classList.add('text-white');
                }

                // Remove the flash class after the animation completes
                setTimeout(() => el.classList.remove('flash'), 700);
            }
        }


        // --- INITIALIZATION ---

        // Initial fetch when the page loads
        fetchData();

        // Set up an interval to fetch new data every 60 seconds (60000 milliseconds)
        setInterval(fetchData, 60000);

    </script>
</body>
</html>
